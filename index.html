<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>title</title>
  </head>
  <body>
    <div class="words"></div>Hours worked per week:<div>
    <input type="number" id="hoursWorkedPerWeek" />
    <div class="words"></div>Full-time annual leave entitlement (days): <div>
    <input type="number" id="fullTimeAnnualLeaveEntitlementDays" />
    <div class="words"></div>Pro rata annual leave entitlement (hours):<div>
    <div id="proRataAnnualLeaveEntitlementHours"></div>
    <div class="words"></div>Date Started:<div>
    <input type="date" id="dateStarted" />
    <div class="words"></div>Date Finished:<div>
    <input type="date" id="dateFinished" />
    <div class="words"></div>Pro rata annual leave entitlement for the period (hrs):<div>
    <div id="proRataAnnualLeaveEntitlementForThePeriodHours"></div>

  <script type="text/javascript">
    var hoursWorkedPerWeek = 37.5
    var fullTimeHoursPerWeek = 37.5
    var numberOfBankHolidays = 8
    var fullTimeAnnualLeaveEntitlementDays = 25
    var proRataAnnualLeaveEntitlementHours = 187.5
    var dateStarted
    var dateFinished
    var proRataAnnualLeaveEntitlementForThePeriodHours = 187.5

    function autorun () {
      refreshFields()
      var hpw = document.getElementById('hoursWorkedPerWeek')
      hpw.addEventListener('input', function (hpw) {
        hoursWorkedPerWeek = hpw.target.value
        deriveFields()
      }, false)
      hpw.onpropertychange = hpw.oninput

      var ftaled = document.getElementById('fullTimeAnnualLeaveEntitlementDays')
      ftaled.addEventListener('input', function (ftaled) {
        fullTimeAnnualLeaveEntitlementDays = ftaled.target.value
        deriveFields()
      }, false)
      ftaled.onpropertychange = ftaled.oninput

      var ds = document.getElementById('dateStarted')
      ds.addEventListener('input', function (ds) {
        dateStarted = ds.target.value
        deriveFields()
      }, false)
      ds.onpropertychange = ds.oninput

      var df = document.getElementById('dateFinished')
      df.addEventListener('input', function (df) {
        dateFinished = df.target.value
        deriveFields()
      }, false)
      df.onpropertychange = df.oninput
    }

    function deriveFields () {
      var hoursNeededForBankHolidays = (fullTimeHoursPerWeek * (numberOfBankHolidays / 5))
      var proRataAnnualLeaveEntitlementHourstemp = (hoursWorkedPerWeek * (+fullTimeAnnualLeaveEntitlementDays + numberOfBankHolidays) / 5)
      proRataAnnualLeaveEntitlementHours = proRataAnnualLeaveEntitlementHourstemp - hoursNeededForBankHolidays
      var ds = new Date(dateStarted)
      var df = new Date(dateFinished)
      var years = ((df.getTime() - ds.getTime()) / (1000 * 60 * 60 * 24)) / (365 + leapYearBetweenDates(ds, df))
      proRataAnnualLeaveEntitlementForThePeriodHours = years * proRataAnnualLeaveEntitlementHourstemp - (years * hoursNeededForBankHolidays)
      refreshFields()
    }

    function leapYearBetweenDates (startDate, endDate) {
      var lastFebruaryLeapYear = endDate.getFullYear()
      if (endDate.getMonth() > 2) {
      } else {
        lastFebruaryLeapYear -= 1
      }
      lastFebruaryLeapYear = findLatestLeapYear(lastFebruaryLeapYear)
      var lastFebruary29th = new Date(lastFebruaryLeapYear, 2, 29)
      if ((endDate - startDate) > (endDate - lastFebruary29th)) {
        return 1 + (Math.floor(Math.round(((lastFebruary29th - startDate) / (1000 * 60 * 60 * 24)) / 365) / 4))
      }
      return 0
    }

    function findLatestLeapYear (year) {
      if (leapYear(year)) {
        return year
      } else {
        return findLatestLeapYear(year - 1)
      }
    }

    function leapYear (year) {
      return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0)
    }

    function refreshFields () {
      document.getElementById('hoursWorkedPerWeek').value = hoursWorkedPerWeek
      document.getElementById('fullTimeAnnualLeaveEntitlementDays').value = fullTimeAnnualLeaveEntitlementDays
      document.getElementById('proRataAnnualLeaveEntitlementHours').innerHTML = proRataAnnualLeaveEntitlementHours
      document.getElementById('proRataAnnualLeaveEntitlementForThePeriodHours').innerHTML = proRataAnnualLeaveEntitlementForThePeriodHours
    }

    if (window.addEventListener) window.addEventListener('load', autorun, false)
    else if (window.attachEvent) window.attachEvent('onload', autorun)
    else window.onload = autorun
  </script>
  </body>
</html>